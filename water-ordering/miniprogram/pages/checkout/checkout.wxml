<!-- 结算页 -->
<view class="container">
  <view class="address-section">
    <!-- 有地址时，点击选择地址 -->
    <view class="address-content" wx:if="{{selectedAddress}}" bindtap="selectAddress">
      <view class="address-info">
        <view class="address-header">
          <text class="name">{{selectedAddress.name}}</text>
          <text class="phone">{{selectedAddress.phone}}</text>
          <text class="default-tag" wx:if="{{selectedAddress.is_default}}">默认</text>
        </view>
        <text class="address-text">{{selectedAddress.province}}{{selectedAddress.city}}{{selectedAddress.district}}{{selectedAddress.detail}}</text>
      </view>
      <text class="arrow">></text>
    </view>
    
    <!-- 无地址时，显示添加地址按钮 -->
    <view class="address-empty" wx:else bindtap="addAddress">
      <text class="add-icon">+</text>
      <text class="add-text">添加收货地址</text>
    </view>
  </view>
  
  <view class="items-section">
    <view class="section-title">商品信息</view>
    <view class="item-list">
      <view class="checkout-item" wx:for="{{items}}" wx:key="product_id">
        <image 
          class="item-image" 
          src="{{item.product_image || ''}}" 
          mode="aspectFill"
        ></image>
        <view class="item-info">
          <text class="item-name">{{item.product_name}}</text>
          <view class="item-meta">
            <text class="item-price">¥{{item.price}}</text>
            <text class="item-quantity">x{{item.quantity}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <view class="footer">
    <view class="total-info">
      <text class="total-label">合计:</text>
      <text class="total-amount">¥{{totalAmount}}</text>
    </view>
    <button class="submit-btn" bindtap="submitOrder" disabled="{{loading || !selectedAddress}}">
      {{loading ? '提交中...' : '提交订单'}}
    </button>
  </view>
</view>

